        ORG     0x010
COUNT:  WORD    ?
COUNTCHET:  WORD    ?
SUMM:  WORD    ?

ADDR:   WORD    0x156
ADDR1:  WORD    ?
ADDR2:  WORD    ?
ADDR3:  WORD    ?
COUNT1:      WORD    ?
COUNT2:      WORD    ?
COUNT3:      WORD    ?
I:      WORD    ?
J:      WORD    ?
K:      WORD    ?
        ORG     0x030
START:  CLA
        ST      COUNT      ; обнуление счетчика
        ST      I      ; обнуление счетчика
        ST      J      ; обнуление счетчика
        ST      K      ; обнуление счетчика
        LD      ADDR       ; загрузка адреса первой ячейки массива
        ST      ADDR1     ; установка счетчика внешнего массива = адрес первой ячейки массива
        LD      #5
        ST      COUNT1
        LD      #0
        ST      I
CYC1:   LD      I
        INC
        ST      I
        LD      (ADDR1)+    ; Загрузка следующей ячейки внешнего массива
        ST      ADDR2      ; Установка счетчика промежуточного цикла
        LD      #3
        ST      COUNT2
        LD      #0
        ST      J
CYC2:   LD      J
        INC
        ST      J
        LD      (ADDR2)+    ; Загрузка следующей ячейки промежуточного массива
        ST      ADDR3      ; Установка счетчика внутреннего цикла
        LD      #4
        ST      COUNT3
        LD      #0
        ST      K
CYC3:   LD      K
        OUT     2
        INC
        ST      K
        CALL    COUNT_GT
        CALL    COUNT_SUMM
        CALL    COUNT_CHET
        PUSH    I
        CALL    FUNC
        POP
        LD      (ADDR3)+
CONT3:  LOOP    COUNT3
        JUMP    CYC3
CONT2:  LOOP    COUNT2
        JUMP    CYC2
CONT1:  LOOP    COUNT1
        JUMP    CYC1
RES:    LD      SUMM
        OUT     2
STOP:   HLT

COUNT_GT:
        LD      (ADDR3)
        CMP     #0x00A
        BLO     END1
        LD      (COUNT)+
END1:    RET

COUNT_CHET:
        LD      (ADDR3)
        ROR
        BCS     END2
        ROL
        LD      (COUNTCHET)+
END2:   RET

COUNT_SUMM:
        LD      (ADDR3)
        ADD     SUMM
        ST      SUMM
        RET

FUNC:   LD      &1
        ROR
        BCS     END3
        ROL
        ASL
        ADD     #17
        ST      &1
END3:   RET


        ORG     0x156
        WORD    0x015B, 0x015E, 0x0161, 0x0164, 0x0167, 0x016A, 0x016E, 0x0172, 0x0176, 0x017A, 0x017E, 0x0182, 0x0186, 0x018A, 0x018E, 0x0192, 0x0196, 0x019A, 0x019E, 0x01A2, 0x1BF3, 0x0E90, 0x0DA7, 0xEAC0, 0x1D7B, 0x0111, 0x0854, 0x175E, 0xF32B, 0x162C, 0xF19D, 0x0440, 0xE1E1, 0x0FCC, 0x08C3, 0xF52D, 0xFE2B, 0xF636, 0x1BE5, 0xF6C6, 0x1DF1, 0xFA89, 0x0C87, 0x0126, 0x1241, 0x1435, 0xF18E, 0xF038, 0x056F, 0xFA4B, 0xE7A2, 0x1B8D, 0x10D3, 0xE7DB, 0xFF5C, 0xE077, 0xF17F, 0x09CA, 0x160A, 0x01CF, 0x10C8, 0xF82F, 0xE551, 0xF662, 0x1C6F, 0xF7B7, 0x04F4, 0xFC7B, 0xE7C7, 0x1AC2, 0xE95D, 0x1F3E, 0x16A8, 0x007B, 0xE57B, 0xFA9F, 0x0C0C, 0xE881, 0xFEFC, 0x012E